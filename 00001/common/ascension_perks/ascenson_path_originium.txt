@ascension_path_base_weight = 100
@ascension_path_synergy_weight = 2
@ascension_path_anti_synergy_weight = 0.5

# Originium Ascension  (regular empires & Hive Minds)
ap_originium_resonance = {
    on_enabled = {
        if = {
            limit = {
            }
            hidden_effect = {
                country_event = { id = ori_ap.1 }
            }
            custom_tooltip = "originium_resonance_originium_tt"
            set_country_flag = originium_research_facility_unlocked
        }
        # ?
        else_if = {
            limit = {
            }
            hidden_effect = {
                country_event = { id = ori_ap.1 }
            }
            custom_tooltip = "originium_resonance_wilderness_tt"
        }
        # else = {
        #     custom_tooltip = "originium_resonance_tt"
        # }
    }

    possible = {
        # custom_tooltip = {
        #     fail_text = "synthetic_empire_biological_ascension"
        #     NOT = { has_trait = trait_mechanical }
        # }
        if = {
            limit = {
                NOR = {
                    has_origin = origin_clone_army
                    has_origin = origin_overtuned
                }
            }
            custom_tooltip = {
                fail_text = "requires_ascension_perks_2"
                num_ascension_perks > 1
            }
        }

        if = {
            limit = {
                has_origin = origin_overtuned
            }
            custom_tooltip = {
                fail_text = "requires_ascension_perks_1"
                num_ascension_perks > 0
            }
        }
        custom_tooltip = {
            fail_text = "requires_not_ap_the_flesh_is_weak"
            NOT = { has_ascension_perk = ap_the_flesh_is_weak }
        }
        custom_tooltip = {
            fail_text = "requires_not_ap_organo_machine_interfacing"
            NOT = { has_ascension_perk = ap_organo_machine_interfacing }
        }
        custom_tooltip = {
            fail_text = "requires_not_ap_mind_over_matter"
            NOT = { has_ascension_perk = ap_mind_over_matter }
        }
        custom_tooltip = {
            fail_text = "requires_not_ap_synthetic_evolution"
            NOT = { has_ascension_perk = ap_synthetic_evolution }
        }
        custom_tooltip = {
            fail_text = "requires_not_ap_engineered_evolution"
            NOT = { has_ascension_perk = ap_engineered_evolution }
        }
        custom_tooltip = {
            fail_text = "requires_not_ap_synthetic_age"
            NOT = { has_ascension_perk = ap_synthetic_age }
        }
        custom_tooltip = {
            fail_text = "requires_free_tradition_tree"
            num_tradition_categories < @max_tradition_trees
        }
    }
    potential = {
        OR = {
            has_utopia = yes
            has_biogenesis_dlc = yes
        }
        NOR = {
            has_ascension_perk = ap_engineered_evolution
            has_origin = origin_shroudwalker_apprentice
            has_origin = origin_cybernetic_creed
            has_origin = origin_synthetic_fertility
            has_origin = origin_evolutionary_predators
        }
        NOT = { has_valid_civic = civic_augmentation_bazaars }
    }
# ?
    # tradition_swap = {
    #     inherit_effects = yes
    #     inherit_icon = yes
    #     name = ap_originium_resonance_wilderness
    #     trigger = {
    #         is_wilderness_empire = yes
    #     }
    # }

    ai_weight = {
        factor = @ascension_path_base_weight
        # modifier = {
        #     factor = @ascension_path_synergy_weight
        #     has_engineered_evolution_synergy = yes
        # }
    }
}

ap_origenesis = {
    potential = {
        NOR = {
            has_ascension_perk = ap_become_the_crisis
            has_ascension_perk = ap_cosmogenesis
            has_ascension_perk = ap_defender_of_the_galaxy
            has_ascension_perk = ap_origenesis
            has_ascension_perk = ap_behemoths
            has_origin = origin_slavers # No crisis for MSI
        }

        is_wilderness_empire = no
    }

    possible = {
        # custom_tooltip = {
        #     fail_text = "requires_ascension_perks_3"
        #     num_ascension_perks > 2
        # }
        custom_tooltip = {
            fail_text = "requires_independence"
            is_subject = no
        }
        custom_tooltip = {
            fail_text = "must_not_be_custodian"
            is_galactic_custodian = no
        }
        custom_tooltip = {
            fail_text = "must_not_be_emperor"
            is_galactic_emperor = no
        }
    }

    on_enabled = {
        hidden_effect = {
            set_ai_personality = origenesis_avatar
            country_event = { id = ori_timeline.69 } # Timeline Become the crisis
        }
        activate_crisis_progression = origenesis_path
    }

    ai_weight = {
        factor = 7.5
        modifier = {
            factor = 0
            NOR = {
                is_militarist = yes
                is_xenophobe = yes
                is_gestalt = yes
            }
        }
        modifier = {
            factor = 10
            is_homicidal = yes
        }
        modifier = {
            factor = 2
            has_tradition = tr_supremacy_finish
        }
        modifier = {
            factor = 2
            has_ascension_perk = ap_mind_over_matter
        }
        modifier = {
            factor = 2
                owner_species = { has_trait = trait_psionic }
        }
        modifier = {
            factor = 2
            has_ascension_perk = ap_mind_over_matter
        }
        modifier = {
            factor = 0
            galaxy_percentage < 0.1
        }
        modifier = {
            factor = 2
            galaxy_percentage > 0.2
        }
        modifier = {
            factor = 2
            has_ascension_perk = ap_originium_resonance
        }
        modifier = {
            factor = 0
            count_playable_country = {
                count > 1
                limit = {
                    has_ascension_perk = ap_become_the_crisis
                }
            }
        }
        modifier = {
            factor = 0
            blocks_disruptive_gameplay = yes
        }
    }
}